<html><head><base href="https://inventory.manager.app/" />
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Gestor de Inventario Moderno</title>
<script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
<script src="https://unpkg.com/html5-qrcode"></script>
<style>
  :root {
    --primary-color: #3498db;
    --secondary-color: #2ecc71;
    --background-color: #f4f4f4;
    --text-color: #333;
    --nav-width: 200px;
  }
  
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 0;
    padding: 0;
    background-color: var(--background-color);
    color: var(--text-color);
    display: flex;
    flex-direction: column;
  }
  
  nav {
    width: 100%;
    background-color: var(--primary-color);
    padding: 10px 0;
    position: sticky;
    top: 0;
    z-index: 1000;
  }
  
  nav ul {
    list-style-type: none;
    padding: 0;
    margin: 0;
    display: flex;
    justify-content: space-around;
  }
  
  nav li {
    padding: 10px 15px;
    cursor: pointer;
    transition: background-color 0.3s;
    text-align: center;
  }
  
  nav li:hover {
    background-color: rgba(255, 255, 255, 0.1);
  }
  
  nav li.active {
    background-color: var(--secondary-color);
  }
  
  main {
    padding: 20px;
    flex-grow: 1;
  }
  
  .section {
    display: none;
    animation: fadeIn 0.5s;
  }
  
  .section.active {
    display: block;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; }
    to { opacity: 1; }
  }
  
  h1, h2 {
    color: var(--primary-color);
    text-align: center;
  }
  
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 20px;
    box-shadow: 0 0 20px rgba(0, 0, 0, 0.1);
  }
  
  th, td {
    border: none;
    padding: 12px;
    text-align: left;
  }
  
  th {
    background-color: var(--primary-color);
    color: white;
  }
  
  tr:nth-child(even) {
    background-color: #f2f2f2;
  }
  
  .input-group {
    display: flex;
    flex-direction: column;
    align-items: center;
    margin-bottom: 20px;
  }
  
  input, button {
    margin: 10px 0;
    padding: 10px;
    border: none;
    border-radius: 5px;
    width: 100%;
    max-width: 250px;
  }
  
  input {
    border: 1px solid #ddd;
  }
  
  button {
    background-color: var(--secondary-color);
    color: white;
    cursor: pointer;
    transition: background-color 0.3s;
  }
  
  button:hover {
    background-color: #27ae60;
  }
  
  #qr-reader, #qr-reader-salida {
    width: 100%;
    max-width: 300px;
    margin: 20px auto;
    border: 2px solid var(--primary-color);
    border-radius: 10px;
    overflow: hidden;
  }
  
  .qr-code {
    margin: 10px 0;
    display: flex;
    justify-content: center;
  }
  
  @media print {
    .no-print {
      display: none;
    }
  }
  
  @media (max-width: 768px) {
    nav li {
      padding: 10px 5px;
      font-size: 14px;
    }
    
    table {
      font-size: 14px;
    }
    
    th, td {
      padding: 8px;
    }
    
    .qr-code {
      transform: scale(0.8);
    }
  }
  
  @media (max-width: 480px) {
    nav li {
      padding: 8px 3px;
      font-size: 12px;
    }
    
    h1 {
      font-size: 24px;
    }
    
    table {
      font-size: 12px;
    }
    
    th, td {
      padding: 6px;
    }
    
    .qr-code {
      transform: scale(0.7);
    }
    
    input, button {
      font-size: 14px;
    }
  }
</style>
</head>
<body>
  <nav class="no-print">
    <ul>
      <li onclick="showSection('stock')" id="stockNav">Stock</li>
      <li onclick="showSection('entrada')" id="entradaNav">Entrada</li>
      <li onclick="showSection('salida')" id="salidaNav">Salida</li>
    </ul>
  </nav>
  
  <main>
    <section id="stock" class="section">
      <h1>Stock de Inventario</h1>
      <div style="overflow-x: auto;">
        <table id="inventoryTable">
          <tr>
            <th>Producto</th>
            <th>Cantidad</th>
            <th class="no-print">QR</th>
            <th class="no-print">Acciones</th>
          </tr>
        </table>
      </div>
    </section>
    
    <section id="entrada" class="section">
      <h1>Entrada de Productos</h1>
      <div class="input-group">
        <input type="text" id="productName" placeholder="Nombre del producto">
        <input type="number" id="productQuantity" placeholder="Cantidad">
        <button onclick="addOrUpdateProduct()">Agregar o Actualizar</button>
      </div>
      <div id="qr-reader"></div>
      <div class="input-group">
        <input type="text" id="manualProductId" placeholder="Nombre del producto (escaneado)" readonly>
        <input type="number" id="changeQuantity" placeholder="Cantidad a agregar">
        <button onclick="changeStock(true)">Actualizar Stock</button>
      </div>
    </section>
    
    <section id="salida" class="section">
      <h1>Salida de Productos</h1>
      <div id="qr-reader-salida"></div>
      <div class="input-group">
        <input type="text" id="manualProductIdSalida" placeholder="Nombre del producto (escaneado)" readonly>
        <input type="number" id="changeQuantitySalida" placeholder="Cantidad a retirar">
        <button onclick="changeStock(false)">Actualizar Stock</button>
      </div>
    </section>
  </main>

  <script>
    let inventory = [];

    function showSection(sectionId) {
      document.querySelectorAll('.section').forEach(section => section.classList.remove('active'));
      document.getElementById(sectionId).classList.add('active');
      document.querySelectorAll('nav li').forEach(li => li.classList.remove('active'));
      document.getElementById(sectionId + 'Nav').classList.add('active');
    }

    function addOrUpdateProduct() {
      const name = document.getElementById('productName').value;
      const quantity = parseInt(document.getElementById('productQuantity').value);
      if (name && quantity) {
        const existingProduct = inventory.find(p => p.name === name);
        if (existingProduct) {
          existingProduct.quantity += quantity;
        } else {
          const product = { name, quantity };
          inventory.push(product);
        }
        updateTable();
        document.getElementById('productName').value = '';
        document.getElementById('productQuantity').value = '';
      }
    }

    function updateTable() {
      const table = document.getElementById('inventoryTable');
      while (table.rows.length > 1) {
        table.deleteRow(1);
      }
      inventory.forEach(product => {
        const row = table.insertRow();
        row.insertCell(0).textContent = product.name;
        row.insertCell(1).textContent = product.quantity;
        const qrCell = row.insertCell(2);
        qrCell.className = 'no-print';
        const qrDiv = document.createElement('div');
        qrDiv.className = 'qr-code';
        new QRCode(qrDiv, product.name);
        qrCell.appendChild(qrDiv);
        const actionCell = row.insertCell(3);
        actionCell.className = 'no-print';
        const printButton = document.createElement('button');
        printButton.textContent = 'Imprimir QR';
        printButton.onclick = () => printQR(product.name);
        actionCell.appendChild(printButton);
      });
    }

    function changeStock(isEntry) {
      const name = isEntry ? document.getElementById('manualProductId').value : document.getElementById('manualProductIdSalida').value;
      const change = parseInt(isEntry ? document.getElementById('changeQuantity').value : -document.getElementById('changeQuantitySalida').value);
      const product = inventory.find(p => p.name === name);
      if (product) {
        product.quantity += change;
        if (product.quantity < 0) product.quantity = 0;
        updateTable();
        if (isEntry) {
          document.getElementById('manualProductId').value = '';
          document.getElementById('changeQuantity').value = '';
        } else {
          document.getElementById('manualProductIdSalida').value = '';
          document.getElementById('changeQuantitySalida').value = '';
        }
      } else {
        if (isEntry && change > 0) {
          inventory.push({ name, quantity: change });
          updateTable();
          document.getElementById('manualProductId').value = '';
          document.getElementById('changeQuantity').value = '';
        } else {
          alert('Producto no encontrado');
        }
      }
    }

    function printQR(name) {
      const printWindow = window.open('', '', 'width=400,height=400');
      printWindow.document.write(`
        <html>
          <head>
            <title>Imprimir QR</title>
            <style>
              body { 
                display: flex; 
                justify-content: center; 
                align-items: center; 
                height: 100vh; 
                flex-direction: column; 
              }
            </style>
            <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"><\/script>
          </head>
          <body>
            <h2>${name}</h2>
            <div id="qrcode"></div>
            <script>
              new QRCode(document.getElementById("qrcode"), "${name}");
              setTimeout(() => { window.print(); window.close(); }, 250);
            <\/script>
          </body>
        </html>
      `);
      printWindow.document.close();
      printWindow.focus();
    }

    const html5QrcodeScanner = new Html5QrcodeScanner(
      "qr-reader", { fps: 10, qrbox: { width: 250, height: 250 } }
    );
    html5QrcodeScanner.render(onScanSuccess);

    const html5QrcodeScannerSalida = new Html5QrcodeScanner(
      "qr-reader-salida", { fps: 10, qrbox: { width: 250, height: 250 } }
    );
    html5QrcodeScannerSalida.render(onScanSuccessSalida);

    function onScanSuccess(decodedText) {
      document.getElementById('manualProductId').value = decodedText;
    }

    function onScanSuccessSalida(decodedText) {
      document.getElementById('manualProductIdSalida').value = decodedText;
    }

    showSection('stock');
    updateTable();
  </script>
</body>
</html>
